---
title: "记一次服务无日志退出情况排查"
date: 2023-09-26T11:00:01+08:00
categories:
- 收件箱
- 工作记录
tags:
- 案例
- log
keywords:
- log
#thumbnailImage: //example.com/image.jpg
---
记一次服务无日志退出情况排查
<!--more-->
突然收到通知，说服务挂了，让我瞬间懵逼，想着这都运行了这么久都没问题怎么突然就挂了，有点不知所措。平复了一下心情，这时候预先制定的程序就排上了用场，先view一下日志，日志没有报错，是收到退出信号后正常退出的。那么问题来了，什么服务发送了退出信号呢？此时我也很迷惑，于是优先想到最常出现的系统发送的信号，于是翻了翻系统日志，并没有有用的信息，水面很平静，那么是什么服务发送了退出信号呢？想了想，还是看看docker守护进程的日志吧，也许有发现呢？真不愧是我，真的让我发现了端倪，每天的四点都会有退出信号，那么是程序问题吗？谁平白无故会让自己的程序这么准时退出呢？这个方向可能性并不是很大，是否有另一个可能：定时任务。定时任务重启服务。通过查看crontab，还真的让我找到了，每天凌晨四点重启服务，但按理说容器的restart策略已经可以覆盖自动退出的所有场景了，为什么端口被占用后没有启动成功呢？这个问题让我百思不得其解，实在没办法，于是怀疑是进程没退出，导致always策略不起作用。问了下对应的程序员，果然，监听失败并不会退出进程。好了真相大白了==，真是激情澎湃的一天。